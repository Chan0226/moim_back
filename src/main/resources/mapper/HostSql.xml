<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="data.mapper.HostMapper">

    <select id="getHostList" resultType="HostDto">
        select *
        from host
        order by num desc
    </select>

    <!--방 전체 리스트-->
    <select id="getRoomList" resultType="RoomDto">
        select *
        from room
        order by num desc
    </select>

    <select id="getHostInfoList" resultType="HostDto" parameterType="int">
        select *
        from host
        where num = #{num}
    </select>

    <!--메인카테고리 리스트-->
    <select id="getMainCategoryList" resultType="MainCategoryDto">
        select *
        from mainCategory
        order by num desc
    </select>

    <!--카테고리 리스트-->
    <select id="getCategoryList" resultType="CategoryDto">
        select *
        from category
        order by num desc
    </select>

    <!--인서트 기본-->
    <insert id="insertRoom" parameterType="RoomDto">
        insert into room (name, oneIntroduction, fullIntroduction, thumbnailImage, address, address2,
        writeday,lat,lng,hostNum)
        values (#{name}, #{oneIntroduction}, #{fullIntroduction}, #{thumbnailImage}, #{address},
        #{address2},now(),#{lat},#{lng},1)
        <selectKey keyProperty="num" resultType="int" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>
    </insert>

    <!--Num값 가져오기-->
    <select id="getData" parameterType="int" resultType="RoomDto">
        select *
        from room
        where num = #{num}
    </select>

    <!--인서트 업데이트-->
    <update id="insertUpdateRoom" parameterType="RoomDto">
        update room
        set headcount=#{headcount},
            stime=#{stime},
            etime=#{etime},
            holiday=#{holiday},
            floor=#{floor},
            parking=#{parking},
            elevator=#{elevator},
            payment=#{payment},
            weekAmPrice=#{weekAmPrice},
            weekPmPrice=#{weekPmPrice},
            holiAmPrice=#{holiAmPrice},
            holiPmPrice=#{holiPmPrice}
        where num = #{num}
    </update>

    <!--삭제-->
    <delete id="deleteRoom" parameterType="int">
        delete
        from room
        where num = #{num}
    </delete>

    <!-- 옵션인서트 -->
    <insert id="insertRoomOption" parameterType="java.util.HashMap">
        insert into roption (oname, price, oimageUrl, roomNum)
        values
        <foreach collection="OptionList" item="item" separator=",">
            (#{item.oname}, #{item.price}, #{item.oimageUrl}, #{item.roomNum})
        </foreach>
    </insert>

    <!--    인포메이션 인서트-->
    <insert id="insertInformation" parameterType="InformationDto">
        insert into information (icontent, roomNum) value
            (#{icontent}, #{roomNum})
    </insert>

    <!--주의사항 인서트-->
    <insert id="insertPrecaution" parameterType="PrecautionDto">
        insert into precaution (pcontent, roomNum)
        values (#{pcontent}, #{roomNum})
    </insert>


    <!--룸 이미지들 인서트-->
    <insert id="insertRoomImage" parameterType="RoomImageDto">
        insert into roomImage (rimageUrl, roomNum)
        values (#{rimageUrl}, #{roomNum})
    </insert>

    <!--공개비공개-->
    <update id="updateStatus" parameterType="RoomDto">
        update room
        set hideStatus=#{hideStatus}
        where num = #{num}
    </update>

    <!--첫번째 업데이트 폼-->
    <update id="updateForm1" parameterType="RoomDto">
        update room
        set name=#{name},
            oneIntroduction=#{oneIntroduction},
            fullIntroduction=#{fullIntroduction},
            thumbnailImage=#{thumbnailImage},
            address=#{address},
            address2=#{address2},
            lat=#{lat},
            lng=#{lng}
        where num = #{num}
    </update>

    <!--roomNum값 가져오기-->
    <select id="getCategoryData" parameterType="int" resultType="RoomCategoryDto">
        select *
        from roomCategory
        where roomNum = #{roomNum}
    </select>
    <select id="getOptionData" parameterType="int" resultType="RoptionDto">
        select *
        from roption
        where roomNum = #{roomNum}
    </select>
    <select id="getImageData" parameterType="int" resultType="RoomImageDto">
        select *
        from roomImage
        where roomNum = #{roomNum}
    </select>
    <select id="getTagData" parameterType="int" resultType="TagDto">
        select *
        from tag
        where roomNum = #{roomNum}
    </select>
    <select id="getInfoData" parameterType="int" resultType="InformationDto">
        select *
        from information
        where roomNum = #{roomNum}
    </select>
    <select id="getPreData" parameterType="int" resultType="PrecautionDto">
        select *
        from precaution
        where roomNum = #{roomNum}
    </select>
</mapper>


