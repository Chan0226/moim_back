<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="data.mapper.DetailMapper">
    <select id="getRoomData" parameterType="int" resultType="RoomDto">
        select * from room where num=#{num}
    </select>
    <update id="updateReadCount" parameterType="int">
        update room set readCount=readCount+1 where num=#{num}
    </update>
    <select id="getTagName" parameterType="int" resultType="String">
        select tname from tag where roomNum=#{num}
    </select>
    <select id="getImg" parameterType="int" resultType="String">
        select rimageUrl from roomImage where roomNum=#{num}
    </select>
    <select id="getInformation" parameterType="int" resultType="String">
        select icontent from information where roomNum=#{num}
    </select>
    <select id="getPrecaution" parameterType="int" resultType="String">
        select pcontent from precaution where roomNum=#{num}
    </select>

    <!-- category-->
    <select id="getCategoryData" resultType="String" parameterType="int">
        select cname from room r
        inner join roomCategory rc on r.num = rc.roomNum
        inner join category c on rc.categoryNum = c.num
        where r.num = #{num};
    </select>
    <!--facilityList-->
    <select id="getFacilityList" resultType="RoomDto" parameterType="int">
        select fname, imageUrl from room r
        inner join roomFacility rf on r.num = rf.roomNum
        inner join facility f on rf.facilityNum = f.num
        where r.num = #{num};
    </select>

    <!--qna-->
    <select id="getQnaList" resultType="QnADto" parameterType="int">
        select nickname,question,answer,writeday,answerday from QnA q
        inner join member m on q.userNum = m.idx
        where q.roomNum = #{num};
    </select>

</mapper>